---
title: Use Flipbooks to Explain Your Code and Thought Process
author: Bryan Shalloway
date: '2020-06-16'
slug: use-flipbooks-to-explain-your-code-and-thought-process
categories:
  - programming
tags:
  - rstats
  - reproducibility
  - animation
  - tidyverse
output:
  blogdown::html_page:
    toc: false
---



<div id="learning-rs" class="section level1">
<h1>Learning Râ€™s <code>%&gt;%</code></h1>
<p>Using the pipe operator (<code>%&gt;%</code>) is one of my favorite things about coding in R and the <a href="https://www.tidyverse.org/">tidyverse</a>. However when it was first shown to me, I couldnâ€™t understand what the <a href="https://twitter.com/search?q=%23rstats&amp;src=typed_query">#rstats</a> nut describing it was <em>so enthusiastic</em> about. They tried to explain, â€œIt means <em>and then</em> do the next operation.â€ When that didnâ€™t click for me, they continued (while becoming ever more excited) â€œIt <em>passes the previous steps output into the first argument</em> of the next function,â€ stillâ€¦ ğŸ˜ğŸ˜ğŸ˜•.
Self-evident verbs in their code like <code>select()</code>, <code>filter()</code>, <code>summarise()</code> helped me nod along, partly following the operations. Though it wasnâ€™t until I evaluated the code <em>line-by-line</em> that I recognized the pipeâ€™s elegance, power, beauty, simplicity ğŸ˜„!</p>
<p>Now, a few years and reads through <a href="https://r4ds.had.co.nz/">R for Data Science</a> later<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, I will often share my work by keeping the code and output together and showing, line-by-line, what I am building towards. For example whenâ€¦</p>
<p>â€¦ giving a 2019 talk on <em>â€œManaging objects in analytics workflows, using lists as columns in dataframesâ€</em>:</p>
<blockquote>
<iframe width="560" height="315" src="https://www.youtube.com/embed/gme4Fb9JVjk?start=258" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</blockquote>
<p>â€¦ giving a 2017 talk on <em>â€œGetting started with â€˜tidyâ€™ data science in Râ€</em>:</p>
<blockquote>
<iframe width="560" height="315" src="https://www.youtube.com/embed/eeCELJNWEuw?start=474" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</blockquote>
<p>â€¦ promoting a recent blog post on <em>â€œTidy pairwise operationsâ€</em> (though in this case I removed the code):</p>
<blockquote>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
What is your <a href="https://twitter.com/hashtag/tidyverse?src=hash&amp;ref_src=twsrc%5Etfw">#tidyverse</a> (or other <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> ) approach for doing arbitrary pairwise operations across variables? Mine is frequently something like:<br><br>I. nestâ€¦<br>II. expand combosâ€¦ <br>III. filterâ€¦<br>IV. map fun(s)â€¦<br>â€¦<br><br>I wrote a post walking through this: <a href="https://t.co/xRnRf5yh3m">https://t.co/xRnRf5yh3m</a> <a href="https://t.co/Zvxey2gm3H">pic.twitter.com/Zvxey2gm3H</a>
</p>
â€” Bryan Shalloway (<span class="citation">@brshallo</span>) <a href="https://twitter.com/brshallo/status/1271194908477591553?ref_src=twsrc%5Etfw">June 11, 2020</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</blockquote>
<p>However each of these examples were built using PowerPoint (and a lot of copy and pasting of code + output). The series of images are not easily reproducible â€“ I canâ€™t recreate or share how I made these slides (at least not without going through another highly manual exercise). In this post, Iâ€™ll point to resources on how to create these sorts of technical communication materials in ways that are reproducible.</p>
</div>
<div id="flipbooks" class="section level1">
<h1>Flipbooks</h1>
<p>When I started writing this post, I planned to call this type of output a â€œ<strong>LEXPREX</strong>â€ for â€œ<strong>L</strong>ine-by-line <strong>EX</strong>ecution with <strong>PR</strong>inted <strong>EX</strong>amplesâ€ (and a name evocative of the inspiring <a href="https://github.com/tidyverse/reprex">reprex</a> package by <a href="https://twitter.com/JennyBryan%5D">Jenny Bryan</a><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>). But, thankfully, an excellent solution containing thorough explanations (and a much better name) already existed, <a href="https://evamaerey.github.io/flipbooks/about">flipbooks</a>.</p>
<p>At this point you should stop reading this blog and instead go learn about <a href="https://github.com/EvaMaeRey/flipbookr">flipbookr</a>. My post was largely written before I learned about this package<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. Hence the next several sections discuss making flipbook-like solutions (but in ways that would require a great deal more copy-and-pasting of code to implement). See additional resources in tweet below.</p>
<blockquote>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
Wow, thanks <a href="https://twitter.com/KellyBodwin?ref_src=twsrc%5Etfw"><span class="citation">@KellyBodwin</span></a> for the recommendation. <a href="https://twitter.com/EvaMaeRey?ref_src=twsrc%5Etfw"><span class="citation">@EvaMaeRey</span></a> ğŸ“¦ <code>flipbookr</code> is another incredible resource for <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> education that will save me so much time. <br><br>- <a href="https://t.co/WB5jWIOg5h">https://t.co/WB5jWIOg5h</a><br>- <a href="https://t.co/z7NtBVASXl">https://t.co/z7NtBVASXl</a> <a href="https://t.co/9DEQUR1teY">https://t.co/9DEQUR1teY</a>
</p>
â€” Bryan Shalloway (<span class="citation">@brshallo</span>) <a href="https://twitter.com/brshallo/status/1272761990025486336?ref_src=twsrc%5Etfw">June 16, 2020</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</blockquote>
<p>If you are still interested in reading about other (less elegant, less fully featured) approaches to building flipbook-like outputs, continue on.</p>
</div>
<div id="example-with-xaringan" class="section level1">
<h1>Example with xaringan</h1>
<p>The <a href="https://github.com/yihui/xaringan">xaringan</a> package for making slideshows contains highlighting features (and is what <code>flipbookr</code> is built-on). For highlighting <em>code</em>, you can use the trailing comment <code>#&lt;&lt;</code><a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. For highlighting <em>output</em>, there is the <code>highlight.output</code> code chunk option.</p>
<blockquote>
<iframe src="https://slides.yihui.org/xaringan/#31" style="width: 560px; height: 315px;">
</iframe>
</blockquote>
<blockquote>
<iframe width="560" height="315" src="https://slides.yihui.org/xaringan/#32">
</iframe>
</blockquote>
<p><a href="https://twitter.com/mitchoharawild">Mitchell Oâ€™Hara-Wild</a>â€™s 2019 presentation on <em>â€œFlexible futures for <a href="https://github.com/tidyverts/fable">fable</a> functionalityâ€</em> contains a helpful example where he uses these features to build a code walk-through (<a href="https://github.com/mitchelloharawild/fable-combinations-2019/blob/6a55628e1ad156c0040676b7881a799f7f75370a/user2019/index.Rmd">source code</a>).</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DhDOTxojQ3k?start=554" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>See <a href="#more-sophisticated-highlighting">More sophisticated highlighting</a> if your use-case requires more than line-level highlighting.</p>
</div>
<div id="animating-a-flipbook" class="section level1">
<h1>Animating a flipbook</h1>
<p>I sometimes want to convert a flipbook into a gif, e.g.Â for sharing an example in a README or on social media. If you ignored my prior entreaty, this is a second reminder to stop and go read about <code>flipbookr</code>, which contains the <code>code_create_gif_flipbook()</code> function. Just look at the beautiful gif thumbnails of flipbooks on the <a href="https://evamaerey.github.io/flipbooks/about">about page</a>!</p>
<p><img src="/post/2020-06-16-use-flipbooks-to-explain-your-code-and-thought-process_files/flipbookr-example.gif" /></p>
<p><strong>My initial approach (written prior to learning of <code>flipbookr</code>):</strong></p>
<p>If you read the source code at the link in the tweet below, you will see I useâ€¦</p>
<ul>
<li><a href="https://github.com/kbodwin/flair">flair</a> for the code highlighting</li>
<li><a href="https://github.com/yihui/xaringan">xaringan</a> for the slides</li>
<li><a href="https://github.com/rstudio/pagedown">pagedown</a> to convert the html slides into pdf</li>
<li><a href="https://github.com/ropensci/magick">magick</a> to convert the pdf into images, apply a few (hacky) transformations, and then stitch them together into a gif</li>
</ul>
<blockquote>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
â¤ï¸flairğŸ“¦by <a href="https://twitter.com/KellyBodwin?ref_src=twsrc%5Etfw"><span class="citation">@KellyBodwin</span></a> for teaching <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> and explaining the %&gt;% in particular. Here's a quick example using: <code>flair</code> + <code>xaringan</code> â€“&gt; <code>pagedown</code> â€“&gt; <code>magick</code> to make a gif of expanding chain of <a href="https://twitter.com/hashtag/tidyverse?src=hash&amp;ref_src=twsrc%5Etfw">#tidyverse</a> operations: <a href="https://t.co/cSi858dFVa">https://t.co/cSi858dFVa</a> <br><br>(thx also <a href="https://twitter.com/xieyihui?ref_src=twsrc%5Etfw"><span class="citation">@xieyihui</span></a> <a href="https://twitter.com/opencpu?ref_src=twsrc%5Etfw"><span class="citation">@opencpu</span></a> ) <a href="https://t.co/7nvWDabKgm">pic.twitter.com/7nvWDabKgm</a>
</p>
â€” Bryan Shalloway (<span class="citation">@brshallo</span>) <a href="https://twitter.com/brshallo/status/1272737172978905088?ref_src=twsrc%5Etfw">June 16, 2020</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</blockquote>
<p>Next step would have been trying to think through a more programmatic way of building these slides and calling these steps. Thankfully, instead, <a href="https://twitter.com/KellyBodwin">Kelly Bodwin</a> pointed me to <code>flipbookr</code> ğŸ˜„!</p>
<div id="closing-note" class="section level2">
<h2>Closing note</h2>
<p>I highly recommend exploring the <a href="https://education.rstudio.com/blog/">Rstudio Education blog</a>. The site contains some enormously helpful resources for improving your technical communication. It was here that I stumbled on the post <a href="https://education.rstudio.com/blog/2020/05/flair/">Decorate your R code with flair</a> â€“ which inspired me to make a first attempt at building a reproducible animation of line-by-line execution of R code (something Iâ€™d been wanting to do for ages). The positive response and feedback of which led me to learn about <code>flipbookr</code> and inspired me to finish writing this blog post.</p>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="more-sophisticated-highlighting" class="section level2">
<h2>More sophisticated highlighting</h2>
<p>For more sophisticated highlighting of <em>code</em>, use the <a href="https://github.com/kbodwin/flair">flair package</a>. Iâ€™m not sure what to recommend for highlighting changes in <em>output</em> to the consoleâ€¦ perhaps <a href="https://github.com/brodieG/diffobj">diffobj</a> would be an option. You could also just explicitly format the output, e.g.Â using <a href="https://github.com/rstudio/gt">gt</a> or <a href="https://github.com/haozhu233/kableExtra">kableExtra</a> for tabular outputs, or using geoms, annotations, etc. in <a href="https://github.com/tidyverse/ggplot2">ggplot</a>s. And, of course, you can always dive into the html.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>See my notes and solutions <a href="https://brshallo.github.io/r4ds_solutions/">here</a>.<a href="#fnref1" class="footnote-back">â†©</a></p></li>
<li id="fn2"><p>I also considered names such as <code>pexprex</code>, <code>sexprex</code>, <code>pripex</code>, â€¦ Iâ€™ll let the reader guess at the acronyms.<a href="#fnref2" class="footnote-back">â†©</a></p></li>
<li id="fn3"><p>I just donâ€™t know how to â€œkill my darlingsâ€.<a href="#fnref3" class="footnote-back">â†©</a></p></li>
<li id="fn4"><p>Which I prefer over the alternatives of using the leading <code>*</code> or wrapping the message in<code>{{}}</code>.<a href="#fnref4" class="footnote-back">â†©</a></p></li>
</ol>
</div>
